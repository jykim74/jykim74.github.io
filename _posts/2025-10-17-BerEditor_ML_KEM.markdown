---
layout: post
title: "[BerEditor] ML-KEM Key Pair Generation and Key Encapsulation"
tags: [BerEditor, KEM, ML-KEM, PQC, 양자암호]
category: Software
---

**\[This feature is a licensed version feature\]**

If you need a license, you can obtain a 30-day license from the [Program Key Issuance](https://jykim74.mycafe24.com/user_reg.php) page.
This feature can be tested with BerEditor version 2.5.0 or later.

Let's use the [BerEditor](https://jykim74.tistory.com/36) tool to generate a ML-KEM key pair and encrypt/decrypt a symmetric key using the PQC algorithm. The execution environment for this example is set to English. If the language is Korean, the message will be displayed in Korean.

In this example, the execution environment is set to English. If the language is Korean, the message will be displayed in Korean.

## Generating an ML-KEM Key Pair

First, to create an electronic signature, you must create an ML-KEM key pair. To create a key pair, run BerEditor -> Service -> KeyPair Manager. Select Gen KeyPair in KeyPair Manager.

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2Fba5Nd8%2FdJMb9LYg8wO%2FAAAAAAAAAAAAAAAAAAAAACKr-G2ZPS2bGjE-fdOfoYI3kfJ892fBDrCJk4HG-Nru%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1761922799%26allow_ip%3D%26allow_referer%3D%26signature%3DMP%252Fg4WNYurnlKAQJjPturKBd%252BJc%253D">

In the KeyPair window, enter the key pair name, select ML KEM in the PQC section, and select one of the three (KEM_512, KEM_768, KEM_1024) for KeyLength.

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FdfXJID%2FdJMb9XYDxfO%2FAAAAAAAAAAAAAAAAAAAAAJvsGIF9jD2S5CapjGLbI1QgbJW1DdXq_4_lDzIMk5hv%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1761922799%26allow_ip%3D%26allow_referer%3D%26signature%3DsJ0AMuiEIXo2ZSA8E4G4Cfb8BJ4%253D">


Once the key pair is created, you can check the key pair with the name you entered in KeyPair Manager. To view the detailed key value, double-click the key to view the key value.

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FbkT5sd%2FdJMb9WrTa6h%2FAAAAAAAAAAAAAAAAAAAAAKK_spukxVzb_h1C4sZbDTfCU-EpQtDyR2STT-qEIhnb%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1761922799%26allow_ip%3D%26allow_referer%3D%26signature%3Dawy%252F6Vh%252BFXCZh5UPr8fJ6mbFlXU%253D">

In fact, the key pair generated by KeyPair Manager is for testing purposes, so the private key is stored in PEM format as a pure value. KeyPair Manager should be considered for testing purposes rather than for safe storage.

## ML-KEM Encapsulation

To encrypt a key with the generated ML-KEM key pair, select BerEditor->Cryptography->Key Manage.
When the window opens, select the KEM tab. Then, click the Encapsulate radio button (selected by default).
There's no special input data; select the previously generated ML-KEM key from the KeyPair Manager (double-click). Selecting the key will display the Wrapped Key and the generated key value. Internally, the KeyPair Manager reads the public key and encrypts it.

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FcPuLGb%2FdJMb9Qedr4j%2FAAAAAAAAAAAAAAAAAAAAABEWcPCA0I8qtixPHyzwd4fKvGuW_WWzcwejvuqwfTT3%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1761922799%26allow_ip%3D%26allow_referer%3D%26signature%3DlIMC2Y0t3n3KUQIk8WpgnjPuai8%253D">

Here, Wrapped Key is encrypted data, so this value is sent to the side with the private key, and the generated key value is a concept that you use.

## ML-KEM Key Decapsulation

To decrypt a key using the generated ML-KEM key pair, select BerEditor->Cryptography->Key Management.
In the opened window, open the KEM tab and click the Decapsulate radio button.
Enter the Wrapped Key value in the input data field and click the Run button. The KeyPair Manager window will appear, allowing you to select the key to verify. Selecting the previously generated ML-KEM key in the KeyPair Manager will display the decrypted key. Internally, the KeyPair Manager reads the private key and decrypts it.

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FxDzlL%2FdJMb9QFhr7A%2FAAAAAAAAAAAAAAAAAAAAAAEXJQa-Ci34MYpr-CJWari6IksjZgIYqJut7yeQ7lJN%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1761922799%26allow_ip%3D%26allow_referer%3D%26signature%3DY%252Bxe4xsFRxCO%252FofY22F8PAeGZ5w%253D">


## Conclusion

In the current PQC algorithm, in order for both sides to share a symmetric key, the ML-KEM key is used. At this time, the resulting 32-byte key is used to share the key with each other.
